
# 유전 알고리즘 (Genetic Algorithm)
*  다윈의 '진화론'(생물이 환경에 적응하며 진화하는 것)을 본떠 만든 해 탐색 알고리즘이다. 
*  여러 개의 해를 임의로 생성하고, 이에 대해 선택, 교차, 돌연변이 연산을 반통 수행한 후 마지막으로 가장 우수한 해를 찾아 리턴한다.
#
## | 유전 알고리즘 연산

### 1. 선택(Selection) 연산 
- 현재 세대, n개의 후보해 중 우수한 후보해를 선택하는 연산이다.
- 우수한 후보해는 중복되어 선택될 수 있고, 선택되지 못한 후보해가 발생할 수 있으며 선택된 후보해는 n개로 유지된다.
- 간단히 구현하는 방법은, 룰렛 휠(Roulette wheel)이다. 각 후보해들의 적합도에 비례해 원판의 면적을 할당한 후, 원판을 돌려 핀이 가리키는 후보해를 선택한다. 따라서, 각 후보해에 할당되는 원판의 면적은, ![image](https://user-images.githubusercontent.com/101811119/174244945-89564f38-a5fc-413d-aba2-0bd74147ffd6.png) 에 비례한다.
    

### 2. 교차(Crossover) 연산 
-  선택연산 수행 후, 후보해 사이에서 수행된다.
-  염색체가 교차하는 것을 모방한 것으로, 두 후보해에 대해 교차점 이후 부분을 서로 교환하며 연산이 수행된다. 이를 1-점(point) 교차 연산이라 한다.
- 후보해가 길다면 임의로 여러 개의 교차점을 정해 연산할 수 있다.
- 교차 연산은, 선택 연산보다 더 우수한 후보해를 생성하기 위한 연산이다.

    ![image](https://user-images.githubusercontent.com/101811119/174246735-aa0e88da-32e1-4f90-8e9e-b23146b9e519.png)


### 3. 돌연변이(Mutation) 연산 
- 돌연변이 연산은, 아주 적은 확률로 후보해의 일부를 임의로 변형하는 것이다. 이 확률을 돌연변이율이라 한다.
- 예시로, 아래는 두번째 bit에서 0->1로 돌연변이가 일어난 것이다.

    ![image](https://user-images.githubusercontent.com/101811119/174249557-a320305a-6c77-4cbb-95e5-49ffe3b3aed1.png)
- 돌연변이 연산 후에 후보해의 적합도가 더 낮아질 수도 있지만, 다음 세대에 돌연변이가 일어난 후보해와, 다른 후보해들을 교차 연산하며, 이후 세대에서 더욱 우수한 후보해를 생성하려는 목적을 가지고 있다.
#
-> 유전 알고리즘이 항상 최적해를 찾는다는 것은 아니여서, 종료 조건은 일정하지 않다. 따라서 일반적으로 알고리즘을 수행하면서, 더이상 우수한 해가 나타나지 않으면 종료한다.

## | 유전 알고리즘을 통한  최적해 탐색
### 예시)
유전 알고리즘을 통해 아래 2차식의 주어진 구간에서의 최댓값을 찾는다.

![image](https://user-images.githubusercontent.com/101811119/174286710-6014085f-aa7a-4980-8762-3f07abd4bef8.png)

+ 𝑥는 5bit로 이루어진 2진수로 나타낼 수 있다.

+ 주어진 구간에서 무작위로 4개의 후보해들을 생성한다. 이를 초기 세대를 구성하는 후보해들이라고 한다.

+ 위 예제에서, 생성된 후보해가 9, 11, 4, 27 이라 하고, 각 후보해의 적합도는 𝑓(𝑥)로 나타내면 아래와 같다.

![image](https://user-images.githubusercontent.com/101811119/174290121-6b5411b8-4bfe-481b-bd36-861e4da43332.png)

### | 선택연산
+ 선택 연산에서 뽑힌 부모 후보해를 1, 2, 2, 3 이라 하고, 후보해 4는 선택되지 않았다고 가정한다.
+ 여기서, 적합도에 비례하는 원판의 면적을 할당한 후 원판을 돌려 뽑는, '룰렛 휠' 선택 방법을 통해 부모 후보해들을 선택한다. 따라서 이는 적합도에 비례하는 확률을 가진다.
### | 교차연산
+ 후보해 2가 2개이므로, 후보해 2와 1, 후보해 2와 3을 짝지어 교차 연산을 수행한다. 1-점(point) 교차 연산을 수행하며, 아래와 같은 교차점을 선택한다.

![image](https://user-images.githubusercontent.com/101811119/174293232-4f6b7c81-c335-4149-833b-2ed22e1a8bf2.png)

### | 돌연변이연산
+ 위 자식 후보해들 중, 후보해 2의 4번째 bit에서 돌변이가 발생해서 0->1 이 되었다고 가정한다. 

-> 이후 두 번째 세대의 후보해들을 정리하면 아래와 같다.

![image](https://user-images.githubusercontent.com/101811119/174294547-618a2ebb-6e02-4505-9174-744922d4b98e.png)

+ 두 번째 세대에서 평균 접합도가 270.25->313.75로 상승한 것을 확인할 수 있다.

+ 일반적으로, 더 우수한 해가 있는지 확인할 수 없다.

+ 이후 여러 세대를 거쳐가며, 후보해의 적합도가 변하지 않는다면, 유전 알고리즘을 종료한다.

+ 종료 시점에서의 후보해들 중 적합도가 가장 높은 후보해를 리턴한다.


### | 결론
-> 룰렛 휠 방법을 통해 선택 연산을 할 때, 적합도가 높을수록 선택될 확률이 늘어난다. 

-> 따라서 적합도가 높은 후보해와 교차를 통해 자식 세대를 만들어간다. 그렇기에 일반적으로 부모 세대보다 자식 세대에서의 평균 적합도가 올라가게 되고, 최적해를 찾을 확률이 올라가게 된다.



# 유전 알고리즘을 통한 회귀식 추정
- '회귀' -> 평균으로 회귀한다는 것을 의미하며, 두 변수 a, b의 관계가 일반화된 선형 모델에서의 평균으로 돌아가는 것을 의미한다.
- 선형 모델에서, 중심은 예측값과 실제값 차이의 제곱의 합이 최소가 되는 직선을 의미한다. -> 최소제곱법
- 독립변수 x, 종속변수 y 간의 1차 선형 관계를 구한 후 이를 분석한다.

### 예시)
+ 예를 들어, ![image](https://user-images.githubusercontent.com/101811119/174313049-72af540f-0912-4b45-a164-ac528820a188.png) 의 선형 모델에서 에러를 최소화하는 a, b 값을 구한다고 가정한다.

+ 어머니의 나이가 63세 이하인 사람 중 무작위로 선택된 5명의 사람에 대해, 어머니의 나이 x, 본인의 나이 y를 조사했다고 했을 때, 정리하면 아래와 같다.

![image](https://user-images.githubusercontent.com/101811119/174317516-c2917b12-b1dc-4525-8aec-cc592147f07c.png)

+ 각 a, b를 구하는 방법은 아래와 같고, 위에서 구했듯 x평균은 42.8, y평균은 16.6이라 할 때, 필요한 값을 정리한다.

![image](https://user-images.githubusercontent.com/101811119/174321544-6d695118-44f5-4bb5-ba8a-f148dcae91c6.png)
![image](https://user-images.githubusercontent.com/101811119/174319017-256dd2a6-b34e-4f1d-8ac7-5af1f9af4512.png)

+ 따라서 구한 값으로 a, b를 구한다.

![image](https://user-images.githubusercontent.com/101811119/174321306-b7b187bb-dbe2-4226-b227-3db0ef5edbf7.png)

![image](https://user-images.githubusercontent.com/101811119/174322330-4651e221-0133-43fe-92ca-558c21249330.png)
#
-> 위의 과정을 통해 구한 값을 부모 세대에서의 a, b값이라고 하고, 이는 가장 에러가 적게 나는 최적의 a, b값을 의미한다. 

-> 이후 세대를, 유전 알고리즘을 통해 구한 뒤, 이 과정을 반복하며 더욱 최적화된 a, b의 값을 구한다.

#
# | 모의 담금질 기법 (Simulatedn Annealing)
* 높은 온도에서, 액체 상태인 물질이, 온도가 점차 낮아지면서 결정체로 변하는 과정을 본떠 만든 해 탐색 알고리즘이다.

